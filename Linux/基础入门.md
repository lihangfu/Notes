## 开关机

> 开机服务

开机会启动许多程序。在Windows叫做"服务"（service），在Linux叫做"守护进程"（daemon）。

登录方式有三种：

* 命令行登录
* ssh登录
* 图形界面登录

最高权限账户root，可以操作一切。



> 关机

Linux一般作为服务器，很少遇到关机得操作。不得已才关机。

关机命令：==shutdown==

```bash
sync	#将数据内存同步到硬盘中。开机前应该做的事情，防止数据丢失

shutdown	#关机指令，具体操作如下

shutdown -h 10	#十分钟后关机

shutdown -h now	#立马关机

shutdown -h	20:25	#今天20:25关机

shutdown -h	+10	#十分钟后关机

shutdown -r	now	#系统立马重启

shutdown -r +10	#系统十分钟后重启

reboot	#立马重启，相当于shutdown -r	now

halt	#立马关机，相当于shutdown -h	now
```



不管关机还是重启最好先执行sync，把内存数据写入磁盘中。



## 目录结构

1. 一切皆文件
2. 根目录/，所有文件挂载这个节点下

查看系统根目录结构：

```bash
ls /
```



> 根目录

* **/bin**：bin是binary得缩写，这个目录存放着最经常使用得命令
* **/boot**：这里存放的是启动Linux时使用的一些核心文件，包括一些连接文件以及镜像文件。
* **/dev**：dev是Device（设备）的缩写，存放的是Linux的外部设备，在Linux中访问设备的方式和访问文件的方式是相同的。
* ==**/etc**：这个目录用来存放所有的系统管理所需要的配置文件和子目录。==
* ==**/home**：用户的主目录，在Linux中，每个用户都有一个自己的目录，一般该目录名是以用户的账号命名的。==
* **/lib**：这个目录里存放着系统最基本的动态链接共享库，其作用类似于Windows的DLL文件。
* **/lost+found**：这个目录一般情况为空，当系统非法关机后，里面存放一些文件
* **/media**：Linux系统会自动识别一些设备，例如u盘，光驱等等，当识别后，linux会把识别的设备挂载到这个目录下。
* **mnt**：系统提供该目录是为了让用户临时挂载别的文件系统的，我们可以将光驱挂载在/mnt上，然后进入该目录就可以查看光驱里的内容了。
* ==**/opt**：这是给主机额外安装燃尽所摆放的目录。比如你安装一个数据库则就可以放到这个目录下。默认为空。==
* **/proc**：这个目录是一个虚拟的目录，它是系统内存的映射，我们可以通过直接访问这个目录来获取系统信息。
* ==**/root**：该目录为系统管理员的用户主目录。==
* **/sbin**：s就是super user的意思，这里存放的是系统管理员使用的系统管理程序。
* **/srv**：该目录存放一些服务启动之后需要提取的数据。
* **/sys**：这是Linux2.6内核的一个很大的变化。该目录安装了2.6内核中新出现的一个文件系统sysfs。
* **/tmp**：这个目录用来存放临时文件的。
* ==**/usr**：这是一个非常重要的目录，用户的很多应用程序和文件都放在这个目录下，类似于Windows下的program file目录。==
* **/usr/bin**：系统用户使用的应用程序。
* **/usr/sbin**：超级用户使用的比较高级的管理程序和系统守护进程。
* **/usr/src**：内核源代码默认的放置目录。
* ==**/var**：这个目录存放着不断扩充着的东西，我们习惯将那些经常被修改的目录放在这个目录下。包括各种日志文件。==
* **/run**：是一个临时文件系统，存储系统启动以来的信息。当系统重启时，这个目录下的文件应该被删掉或清除。
* **/www**： 存放服务器网站相关的资源，环境，网站的项目





## 目录文件命令

> 绝对路径，相对路径

* **cd：切换目录命令**

  * ./：当前目录
  * ..：上级目录
  * ~：当前用户主目录
  * /：根目录，绝对路径的开头

* **ls：列出目录文件**

  * -a：查看全部文件，包括隐藏文件
  * -l：列出所有文件，包括文件的属性权限，不包含隐藏文件。
  * ls -al：组合使用，功能如上两个

* **mkdir：创建目录**

  * -p：创建多层目录

* **pwd：显示当前目录路径**

* **rmdir：删除目录，无法删除有文件的目录**

  * -p：删除多层目录

* **cp：拷贝文件或者目录**

  * ：源文件（目录） 目的文件（目录）

* **rm：移除文件或者目录**

  * -f：忽略不存在文件，不会出现警告，强制删除

  * -r：递归删除目录

  * -i：互动，删除前询问是否删除

    ```bash
    rm -rf /	#删库跑路
    ```

* **mv：移动文件或者目录，重命名文件**

  * -f：强制
  * -u：只替换已经更新过的文件





## 文件属性权限

```bash
dr-xr-x---. 11 root root     4096 Apr  6 22:43 .
```

* 第一个字符：
  * d：目录
  * -：文件
  * l：链接文档
  * b：装置文件里面的可供存储的接口设备（可随机读取装咋）。
  * c：装置文件里面的串行端口设备，键盘鼠标等（一次性读取装置）。

* 接下来的九个字符，三个为一组：rwx的组合
  * 三组分别为：当前用户权限，当前用户所属组权限，其它用户权限
  * r：代表可读，数字为1
  * w：代表可写，数字为2
  * x：代表可执行，数字为4
* 再往后分别是链接数，所属用户，所属组，大小，修改时间，文件名，链接对象（快捷方式对应的真实文件）



**文件属性权限相关命令**

* **chgrp：更改文件所属组**

  ```bash
  chgrp [-R] 组名 文件名
  ```

  -R：递归更改文件所属组，该目录下所有文件都会修改

* **chown：更改文件所属用户，也可修改文件所属组**

  ```bash
  chown [-R] 所属用户 文件名
  chown [-R] 所属用户:所属组 文件名
  ```

* ==**chmod：更改文件的权限**==

  ```bash
  chmod [-R] 777 文件或目录
  chmod [-R] rwx 文件或目录
  ```

  

## 文件查看命令

* cat：由第一行开始显示文件内容
* tac：从最后一行开始显示
* nl：显示的时候带上行数
* more：一页一页的显示
  * 空格翻页
  * 回车加载一行
  * :f：显示当前到多少行
* less：与more类似，可以往前翻页
  * 空格翻页，上下翻页
  * q：退出
* head：只看头几行
  * -n 数字：看前多少行
  * /要查找的字符串：向下查询
  * ?要查找的字符串：向上查询
  * n：向下继续查找
  * N：向上继续查找
* tail：只看尾巴几行，方法与head类似



## Linux链接

==了解即可==

* 硬链接：A硬链接B，AB指向同一文件！运行一个文件拥有多个路径。类似于Java当中的引用。
* 软连接：类似Windows下的快捷方式，删除源文件，快捷方式失效！



硬链接常用于重要文件上，防止误删。



* ln 文件一 文件二 ：创建文件一的硬链接文件二
* ln -s 源文件 快捷方式：创建源文件的软连接



## Vim编辑器

Vim是从vi发展出来的一个文本编辑器。代码补全，编译及错误跳转等方便编程的功能特别丰富，在程序员中被广泛使用。尤其是Linux中，必须要会使用vim（查看，编辑，保存！）



三种模式：

* 命令模式（Command mode）：

  用户启动vi/vim时，便进入了命令模式。

  此状态下使用键盘会被vim识别为命令，而非字符！

  * i：切换到输入模式，编辑文档
  * x：删除当前光标所在的字符
  * ：：切换到底线命令模式，在最低一行输入命令。

  命令模式只有一些基本命令，因此仍要依靠底线命令模式输入更多命令。

* 输入模式（Insert mode）：

  在命令模式按下i进入输入模式。

  * 字符按键以及shift组合：输入字符
  * ENTER：换行
  * BACK SPACE：删除前一个字符
  * 方向键：在文本中移动光标
  * Home/END：移动光标到行首/行尾
  * Page Up/Page Down：上下翻页
  * Insert：切换光标为输入/替换模式，光标将编程竖线/下划线
  * ESC：退出输入模式。回到命令模式

* 底线命令模式（Last Line mode）：

  在命令模式下按下英文：进入底线命令模式，输入命令！

  底线命令模式，可以输入多个命令组合，例如：wq 退出并保存！

  使用ESC返回命令模式！

  * q：退出程序
  * w：保存文件
  * ！：强制执行



### Vim命令大全

### 命令模式

#### 光标移动

| 命令               | 解释                                                         |
| ------------------ | ------------------------------------------------------------ |
| h 或 向左箭头键(←) | 光标向左移动一个字符                                         |
| j 或 向下箭头键(↓) | 光标向下移动一个字符                                         |
| k 或 向上箭头键(↑) | 光标向上移动一个字符                                         |
| l 或 向右箭头键(→) | 光标向右移动一个字符                                         |
| [Ctrl] + [f]       | 屏幕『向下』移动一页，相当于 [Page Down]按键 (常用)          |
| [Ctrl] + [b]       | 屏幕『向上』移动一页，相当于 [Page Up] 按键 (常用)           |
| [Ctrl] + [d]       | 屏幕『向下』移动半页                                         |
| [Ctrl] + [u]       | 屏幕『向上』移动半页                                         |
| +                  | 光标移动到非空格符的下一行                                   |
| -                  | 光标移动到非空格符的上一行                                   |
| n<space>           | 那个 n 表示『数字』，例如 20 。按下数字后再按空格键，光标会向右移动这一行的 n 个字符。例如 20<space> 则光标会向后面移动 20 个字符距离。 |
| 0 或功能键[Home]   | 这是数字『 0 』：移动到这一行的最前面字符处 (常用)           |
| $ 或功能键[End]    | 移动到这一行的最后面字符处(常用)                             |
| H                  | 光标移动到这个屏幕的最上方那一行的第一个字符                 |
| M                  | 光标移动到这个屏幕的中央那一行的第一个字符                   |
| L                  | 光标移动到这个屏幕的最下方那一行的第一个字符                 |
| G                  | 移动到这个档案的最后一行(常用)                               |
| nG                 | n 为数字。移动到这个档案的第 n 行。例如 20G 则会移动到这个档案的第 20 行(可配合 :set nu) |
| gg                 | 移动到这个档案的第一行，相当于 1G 啊！ (常用)                |
| n<Enter>           | n 为数字。光标向下移动 n 行(常用)                            |

如果你将右手放在键盘上的话，你会发现 hjkl 是排列在一起的，因此可以使用这四个按钮来移动光标。 如果想要进行多次移动的话，例如向下移动 30 行，可以使用 "30j" 或 "30↓" 的组合按键， 亦即加上想要进行的次数(数字)后，按下动作即可！



####  **搜索替换** 

| 命令                                                         | 解释                                                         |
| ------------------------------------------------------------ | ------------------------------------------------------------ |
| /word                                                        | 向光标之下寻找一个名称为 word 的字符串。例如要在档案内搜寻 vbird 这个字符串，就输入 /vbird 即可！ (常用) |
| ?word                                                        | 向光标之上寻找一个字符串名称为 word 的字符串。               |
| n                                                            | 这个 n 是英文按键。代表重复前一个搜寻的动作。举例来说， 如果刚刚我们执行 /vbird 去向下搜寻 vbird 这个字符串，则按下 n 后，会向下继续搜寻下一个名称为 vbird 的字符串。如果是执行 ?vbird 的话，那么按下 n 则会向上继续搜寻名称为 vbird 的字符串！ |
| N                                                            | 这个 N 是英文按键。与 n 刚好相反，为『反向』进行前一个搜寻动作。 例如 /vbird 后，按下 N 则表示『向上』搜寻 vbird 。 |
| 使用 /word 配合 n 及 N 是非常有帮助的！可以让你重复的找到一些你搜寻的关键词！ |                                                              |
| :n1,n2s/word1/word2/g                                        | n1 与 n2 为数字。在第 n1 与 n2 行之间寻找 word1 这个字符串，并将该字符串取代为 word2 ！举例来说，在 100 到 200 行之间搜寻 vbird 并取代为 VBIRD 则： 『:100,200s/vbird/VBIRD/g』。(常用) |
| **:1,$s/word1/word2/g** 或 **:%s/word1/word2/g**             | 从第一行到最后一行寻找 word1 字符串，并将该字符串取代为 word2 ！(常用) |
| **:1,$s/word1/word2/gc** 或 **:%s/word1/word2/gc**           | 从第一行到最后一行寻找 word1 字符串，并将该字符串取代为 word2 ！且在取代前显示提示字符给用户确认 (confirm) 是否需要取代！(常用) |



####  **删除、复制与贴上** 

| x, X     | 在一行字当中，x 为向后删除一个字符 (相当于 [del] 按键)， X 为向前删除一个字符(相当于 [backspace] 亦即是退格键) (常用) |
| -------- | ------------------------------------------------------------ |
| nx       | n 为数字，连续向后删除 n 个字符。举例来说，我要连续删除 10 个字符， 『10x』。 |
| dd       | 删除游标所在的那一整行(常用)                                 |
| ndd      | n 为数字。删除光标所在的向下 n 行，例如 20dd 则是删除 20 行 (常用) |
| d1G      | 删除光标所在到第一行的所有数据                               |
| dG       | 删除光标所在到最后一行的所有数据                             |
| d$       | 删除游标所在处，到该行的最后一个字符                         |
| d0       | 那个是数字的 0 ，删除游标所在处，到该行的最前面一个字符      |
| yy       | 复制游标所在的那一行(常用)                                   |
| nyy      | n 为数字。复制光标所在的向下 n 行，例如 20yy 则是复制 20 行(常用) |
| y1G      | 复制游标所在行到第一行的所有数据                             |
| yG       | 复制游标所在行到最后一行的所有数据                           |
| y0       | 复制光标所在的那个字符到该行行首的所有数据                   |
| y$       | 复制光标所在的那个字符到该行行尾的所有数据                   |
| p, P     | p 为将已复制的数据在光标下一行贴上，P 则为贴在游标上一行！ 举例来说，我目前光标在第 20 行，且已经复制了 10 行数据。则按下 p 后， 那 10 行数据会贴在原本的 20 行之后，亦即由 21 行开始贴。但如果是按下 P 呢？ 那么原本的第 20 行会被推到变成 30 行。 (常用) |
| J        | 将光标所在行与下一行的数据结合成同一行                       |
| c        | 重复删除多个数据，例如向下删除 10 行，[ 10cj ]               |
| u        | 复原前一个动作。(常用)                                       |
| [Ctrl]+r | 重做上一个动作。(常用)                                       |
| .        | 不要怀疑！这就是小数点！意思是重复前一个动作的意思。 如果你想要重复删除、重复贴上等等动作，按下小数点『.』就好了！ (常用) |

这个 u 与 [Ctrl]+r 是很常用的指令！一个是复原，另一个则是重做一次～ 利用这两个功能按键，你的编辑，嘿嘿！很快乐的啦！



### 切换编辑模式命令

####  **进入输入或取代的编辑模式** 

| 命令  | 解释                                                         |
| ----- | ------------------------------------------------------------ |
| i, I  | 进入输入模式(Insert mode)： i 为『从目前光标所在处输入』， I 为『在目前所在行的第一个非空格符处开始输入』。 (常用) |
| a, A  | 进入输入模式(Insert mode)： a 为『从目前光标所在的下一个字符处开始输入』， A 为『从光标所在行的最后一个字符处开始输入』。(常用) |
| o, O  | 进入输入模式(Insert mode)： 这是英文字母 o 的大小写。o 为『在目前光标所在的下一行处输入新的一行』； O 为在目前光标所在处的上一行输入新的一行！(常用) |
| r, R  | 进入取代模式(Replace mode)： r 只会取代光标所在的那一个字符一次；R会一直取代光标所在的文字，直到按下 ESC 为止；(常用) |
| [Esc] | 退出编辑模式，回到一般模式中(常用)                           |

上面这些按键中，在 vi 画面的左下角处会出现『--INSERT--』或『--REPLACE--』的字样。 由名称就知道该动作了吧！！特别注意的是，我们上面也提过了，你想要在档案里面输入字符时， 一定要在左下角处看到 INSERT 或 REPLACE 才能输入喔！



### 切换到命令行可用命令

####  **指令行的储存、离开等指令** 

| 命令                | 解释                                                         |
| ------------------- | ------------------------------------------------------------ |
| :w                  | 将编辑的数据写入硬盘档案中(常用)                             |
| :w!                 | 若文件属性为『只读』时，强制写入该档案。不过，到底能不能写入， 还是跟你对该档案的档案权限有关啊！ |
| :q                  | 离开 vi (常用)                                               |
| :q!                 | 若曾修改过档案，又不想储存，使用 ! 为强制离开不储存档案。    |
| :wq                 | 储存后离开，若为 :wq! 则为强制储存后离开 (常用)              |
| ZZ                  | 这是大写的 Z 喔！若档案没有更动，则不储存离开，若档案已经被更动过，则储存后离开！ |
| :w [filename]       | 将编辑的数据储存成另一个档案（类似另存新档）                 |
| :r [filename]       | 在编辑的数据中，读入另一个档案的数据。亦即将 『filename』 这个档案内容加到游标所在行后面 |
| :n1,n2 w [filename] | 将 n1 到 n2 的内容储存成 filename 这个档案。                 |
| :! command          | 暂时离开 vi 到指令行模式下执行 command 的显示结果！例如 『:! ls /home』即可在 vi 当中察看 /home 底下以 ls 输出的档案信息！ |

注意一下啊，那个惊叹号 (!) 在 vi 当中，常常具有『强制』的意思～



###  **vim 环境的变更** 

| 命令      | 解释                                               |
| --------- | -------------------------------------------------- |
| :set nu   | 显示行号，设定之后，会在每一行的前缀显示该行的行号 |
| :set nonu | 与 set nu 相反，为取消行号！                       |





## 账号管理

用户账号的管理工作主要涉及到用户账号的添加删除和修改。

添加用户需要在系统中创建一个新账号，然后为新账户分配用户号，用户组，主目录和登录Shell等资源。



> useradd命令 添加用户

* useradd -选项 用户名
  * -d：目录 指定用户主目录，如果此目录不存在，则同时使用-m选项，可以创建主目录。
  * -g：用户组 指定用户所属组。
  * -G：用户组，指定用户所属附加组。
  * -m：用户主目录不存在自动创建。
  * -s：shell文件 指定用户登录shell
  * -u：用户号 指定用户的用户号，如果同时有-o选项，则可以重复使用其它用户的标识号。

Linux一切皆文件，用户操作本质就是对/etc/passwd的修改！



> userdel 删除用户

* userdel -r 用户名：删除用户以及用户主目录



> usermod 选项 用户名 修改用户

常用选项-c，-d，-m，-g，-G，，-s，-u以及-o，意思与添加用户一样

```bash
# usermod -s /bin/ksh -d /home/z -g developer zhangsan
```

此命令将用户shangsan的登录shell修改网ksh，主目录修改为/home/z，用户组修改为developer。



> 切换用户

1. 切换用户的命令为：su username
2. 普通用户切换到root用户：sudo或者su
3. 在终端输入exit或logout或使用快捷方式ctrl+d，可以退回原来用户，ctrl+d就是exit命令
4. 在切换用户时，如果想在切换用户之后使用新用户的工作环境，可以在su和username之间加-，例如：su - root
5. $表示普通用户
6. #表示root用户



> hostname 主机名：查看或者修改主机名



> 用户密码设置

我没一般通过root创建用户的时候，配置密码！

passwd 用户名：设置用户的密码

普通用户不需要填用户名，因为只能修改自己的。



> 锁定账户！

passwd -l 用户名

passwd -d 用户名 #删除密码，没有密码也不能登录

锁定的用户不可登录！！！



## 用户组管理

每个用户都有一个用户组，系统可以对一个用户组中的所有用户集中管理（开发，测试，运维，root）。

Linux下的用户属于与它同名用户组，这个用户组在创建用户时同时创建。

用户组管理涉及用户组的添加删除和修改。本质是对/etc/group文件的操作。

> groupadd 添加用户组

创建完成后可以去/etc/group中查看，可以得到一个组的id，这个id可以指定的！-g 520

```bash
$ groupadd -g 520 zhangsan
```



> groupdel 删除用户组

> groupmod 修改用户组

* -g：修改id
* -n：修改组名

 ```bash
$ groupmod -g 666 -n newzhangan zhangsan
 ```



> 用户切换组

```bash
# 登录当前用户 zhangsan
$ newgrp root
```



> 扩展：文件查看

/etc/passwd

```bash
用户名:口令(不可见x):用户标识符:组标识号:注释:主目录:登录shell
```

真正的密码在/etc/shadow，加密！！





## 磁盘管理

> df（列出磁盘整体使用量）df -h
>
> du（检查当前目录磁盘空间使用量）
>
> mount 外部设备 挂载目录   （将外部设备挂载到指定目录）
>
> umount 卸载目录



## 进程管理

1. 在Linux中，每一个程序都有自己的进程id
2. 每一个进程都会有一个父进程
3. 进程可以有两种存在方式：前台，后台运行
4. 一般服务都是后台运行的



* ==**ps：**查看当前系统中正在执行的各种进程的信息！==

  * -a：显示当前终端运行的所有的进程信息（当前的进程一个）
  * -u：以用户的信息显示进程
  * -x：显示后台运行进程的参数！

  ```bash
  $ ps -aux|grep mysql
  
  # | 在Linux这个叫管道，将管道前的输出当作后面的输入
  # grep 过滤
  ```

* **ps -ef**：可以查看父进程信息

* **pstree -pu：**进程树



* **kill -9 进程id：**杀死进程



## 防火墙管理

确保Linux的防火墙是开启的！

在防火墙开启的状态下，若没有开启指定端口，外网是无法访问的！！！

```bash
# 查看firewall服务状态
systemctl status firewalld

# 开启防火墙
service firewalld start
# 重启
service firewalld restart
# 关闭
service firewalld stop

# 查看防火墙规则
firewall-cmd --list-all #查看全部信息
firewall-cmd --list-ports # 只看端口信息

# 开启端口
firewall-cmd --zone=public --add-port=80/tcp --permanent #开端口
systemctl restart firewalld.service

命名含义：
--zone #作用域
--add-port=80/tcp #添加端口，格式为：端口/通讯协议
--permanent +永久生效，没有参数重启后失效
```





## 环境安装

Linux安装软件一般有三种方式：rpm（jdk），解压缩（tomcat），yum在线安装（docker）



### RPM安装JDK

1. 下载jdk的rpm包

2. 安装

   ```bash
   # 检测环境是否存在java环境
   $ java -version
   
   # 有的化卸载
   $ rpm -qa|grep jdk #检查jdk版本信息
   $ rpm -e --nodeos jdk__   # 强制卸载
   
   # 卸载完成后安装jdk
   $ rpm -ivh jdk___.rpm
   
   # 配置环境变量（rpm和yum安装可以不用配置，解压安装必须配置）
   $ vim /etc/profile 
   # 最文件最后添加信息
   JAVA_HOME=/usr/java/jdk1.8.0_221-amd64
   PATH=$PATH;$JAVA_HOME/bin;$JAVA_HOME/jre/bin
   
   # 让环境变量配置生效
   $ source /etc/profile
   ```



### 解压缩包安装tomcat

1. 下载tomcat tar.gz压缩包

2. 解压这个文件

   ```bash
   tar -zxvf apache-tomcat-9.0.00.tar.gz
   
   # 非常简单，有的需要配置环境变量
   ```



### yum安装docker

yum为在线安装，必须联网

```bash
yum -y install 包名
```



不想说了，安装啥就看啥官方文档。。。。

